



NOW:
unit tests graph


REFACTOR STUFF:
switch to poylmer
d3 v4?
simplifyTree in treemgr needs a fixing
 - dont copy stuff between nodes
 - and fix coreqs too?
remove prereqsForThisGraph and the other backup prereqs crap savePrereqsForThisGraph



depriciate _id in frontend

BUGS:
think about how the prereqs are going to be saved when nodes are selected, what will happen when they are unselected
if the graph is loaded with stuff selected and they are unselected does it work?
dont change the search term or result when a result is selected
ghetto trig needs improvement
clear localstorage before user runs and make sure XMLHTTPRequest is mocked out before user is ran too
http://localhost/#/graph/neu.edu/201710/HIST/4701_1656814500
http://localhost/#/graph/neu.edu/201710/EXSC/5230_766102858
scroll down in search results and limit the number that appear until you scroll down
optimize the search, look into weight and expand=true and config in backend

add a warning in keys.getminkeys that dosent crash when using host or term (or just do this logic in base data?)
add a warning in hash comparison when thing



UNIT TESTS:
run all graph unit tests.js (data/tests/runAllGraphSelections_broken.js)





https://coursepro.io/#/graph/ccsu.edu/201640/ACTL/465 --- fixed in master, not in prod


PROD
uglify properties before prod?


TODO====================
ensure invarients hold on tree
 - bugs ahoy
debug why it takes multiple clicks sometimes?
"lab for [subject]\s+\d+" add (and that regex has to be different)
 --- https://wl11gp.neu.edu/udcprod8/bwckctlg.p_disp_course_detail?cat_term_in=201710&subj_code_in=PHYS&crse_numb_in=1152
popup explaining what is going on with the selecting


2. MAKE NEU.EDU/LAW _> NEU.EDU_LAW WORK IN FRONTEND, and standardize the regex everywhere (they are in basedata and in dumpdatabase)
3. shared dir with keys generator and stuff?
4. and can remove keys.obj and key.lookup because they are the same now?





bootstrap over arrow to show coreqs when panel is expanded?



i think its the coreq is in the force diagramm? not sure would do a conditional breakpoint in that d3 math
and can avoid running d3 force at all for the small graphs?








search:
 - server side index generation and save them to disk somewhere? and pass around the url, dont need to, its known
- service workers(for awesomeness and to cache data)
 - by default show panel expanded, maybe with search, but then how show coreqs and prereqs?




clean up this file a lot
make it so user can upgrade localstorage
trello
sms and phone call notifications?
click to select class
get instanceCache off the window, why were different datas using differnet instanceCaches in testing?
cross term data copying for a processor for like swarthmore class descriptions etc
simplifyTree shouldnt copy attrs between nodes

chem 2311 dosent have coreq	s????? it should
https://coursepro.io/#/graph/neu.edu/201710/CHEM/2311
 -- change how this is done, working on it in prereqClassUids, but need some work
 -- moving the logic for this from treeMgr to ^^  DO THIS NEXTTTTTTT AND THEN the collision code?

npm update / npm outdated 


PROCESSORS:
find things for search prefil hint thing
 - at neu it should be International Village and First Year Writing
semester start and end on term -- done
auto recognize which college someone is coming from (not really a processor?) -- done
remove honors coreqs from non hon classes, etc

make the search index and upload it to ec2 bucket




make the collision code for nodes at different tiers use actuall trig and not ghetto trig
- for both updwards and downwards


http://localhost/#/graph/neu.edu/201710/PHYS/1165_1407358073


#5f9337 and #6c994a kindof work for green

#87c3d0 for light blue


// would this work somewhere??
tree.prereqs.values.sort(function (a, b) {
	return b.x - a.x;
}.bind(this))



TO TEST
updateing db due to change in deps???? -- logging chages

resize d3 window on browser size resize -- done
 -- why does the grpah like move a little?


db.sections.createIndex( { "host": 1, "termId": 1 ,"subject": 1,"classUid": 1,"crn": 1   } )





LOOKING INTO
safe to lookup docs by url in backend? - ehhh
max number of simultanous classes wawtching???
Is there some good way to not have a bunch of emails go off whenever change how something is parsed?
can close and reopen the db when not prod?



GRAPH

the swarthmore one i tested a lot - http://localhost/#/graph/swarthmore.edu/201604/MATH/043
coreqs -- done?
arrows
if angle < something between 2 children, do a force or maybe if x is too close between children?



GULP todo
merge html.js and app.js


CLALENDAR
classes can go as late as 10pm, and they are sometimes on weekends
https://myswat.swarthmore.edu/pls/bwckctlg.p_disp_listcrse?term_in=201602&subj_in=PSYC&crse_in=025&schd_in=A



====Parsing warnings that could tell school about====
pre/co reqs that link to invalid classes
classes that say "recistation for " or "lab for" but don't have any coreqs


=== performance === 
is coreq.clone() slowing this down?




this.skipNodesPostStuff(tree); needed 4 times??????



debug this next http://localhost/#/graph/neu.edu/201710/CHEM/2331_2069949756

big graphs
http://localhost/#/graph/neu.edu/201710/ME/4570
http://localhost/#/graph/neu.edu/201710/CHEM/3505_1161594881 

http://localhost/#/graph/neu.edu/201710/EECE/4642_422645136
http://localhost/#/graph/neu.edu/201710/ME/4640_505072758
https://localhost/#neu.edu/201630/CHEM/5622
 -- tree is 419 big

 more kindof big trees
http://localhost/#/graph/neu.edu/201710/IS/4800
http://localhost/#/graph/neu.edu/201710/ME/5250
http://localhost/#/graph/neu.edu/201710/MATH/3331
http://localhost/#/graph/neu.edu/201710/PHYS/1155

!class with depth=1 is above the root node@0?
http://localhost/#/graph/neu.edu/201710/EECE/2530 

if there are a crapton of (a or b or c or d or e or f ... ) do you want to split it into ((a or b or c) or (d or e or f))?
 	(maybe split up the nodes that have prereqs, idk)
http://localhost/#/graph/neu.edu/201710/BIOL/3407













NOTIFICATIONS
trello/sms/phone call/etc









3RD party bugs
nodejs https on that one college that isnt 443?
d3-queue for multiple awaitall? error messages?
gulp-jasmine has a bug not deleting enough files from cache
holy crap nodev6 is bad. gulp watch dosent work and npm install dosent work on armhf
---dont upgrade to nodev6 until this is fixed https://github.com/gulpjs/gulp/issues/1571
----v5.10.1
async.retry and jasmine.clock
d3 collision bug in a bunch of examples on the internet skip testing collision with the first node in the list
--- https://bl.ocks.org/mbostock/3231298

HONORS NOTES
swathmore and sju have "honors" in title 
https://myswat.swarthmore.edu/pls/bwckschd.p_disp_detail_sched?term_in=201602&crn_in=25340
https://myswat.swarthmore.edu/pls/bwckctlg.p_disp_course_detail?cat_term_in=201602&subj_code_in=MATH&crse_numb_in=016H
https://ssb.sju.edu/pls/PRODSSB/bwckctlg.p_disp_course_detail?cat_term_in=201610&subj_code_in=CHM&crse_numb_in=126

clemson has Honors in attributes 
HOWEVER it also has a "includes honors sections" in the dsecription
https://sisssb.clemson.edu/sisbnprd/bwckschd.p_disp_detail_sched?term_in=201608&crn_in=87931

gatech has honors in title




neu has it in attributes, as different sections in same class
https://wl11gp.neu.edu/udcprod8/bwckctlg.p_disp_listcrse?term_in=201710&subj_in=CS&crse_in=1800&schd_in=LEC


TITLE NOTES
some derp names swathmore.log
in swath, would work but need to look into (1) (w) stuff more 
need to keep '-lab' at the end and standardize spacing around dash




// //update existing dep in CATALOG PARSER MAKE SURE IT WORKS and aIS IT POSSIBLE TO ADD A CLASS CODE??



// NEED TO ADD A DID FIND THIS RUN or somethign to each parsing data and then delete the controller.dep unless it was found
 -- what if the controller is not found? need controller if more than 1, else no controller, ahhhh

!!!!
db.collegeNames.remove({host:'neu.edu'})
db.term.remove({host:'neu.edu'})
db.subjects.remove({host:'neu.edu'})
db.links.remove({host:'neu.edu'})
db.classes.remove({host:'neu.edu'})
db.sections.remove({host:'neu.edu'})

db.collegeNames.remove({host:'neu.edu/law'})
db.term.remove({host:'neu.edu/law'})
db.subjects.remove({host:'neu.edu/law'})
db.links.remove({host:'neu.edu/law'})
db.classes.remove({host:'neu.edu/law'})
db.sections.remove({host:'neu.edu/law'})

db.collegeNames.remove({host:'neu.edu/cps'})
db.term.remove({host:'neu.edu/cps'})
db.subjects.remove({host:'neu.edu/cps'})
db.links.remove({host:'neu.edu/cps'})
db.classes.remove({host:'neu.edu/cps'})
db.sections.remove({host:'neu.edu/cps'})

update everything/all classes and not switch out id? or maybe store keys in localStorage and not ids?
find a better way to abstract this.table.update in userdb?


split this into backend and frontend?
finish section.tests.js

jasmine coffeescript
angular coffeescript
lodash coffeescript
ctrl-shift c for color picker

clear out db at beginning of spider? also need to remove neu.edu/law stuff

karma-failed-reporter is better than nothing



spacing bug if multiple locations on class list

put a line between years?

/logError called "class load failed" if failed to load class and then on a separate call to class.load sections

unit tests?
 - testing errors shouldnt bring up debugger
merge list, search, starred?

play with hiding private properties?
 -- nah
 do something with instance, cache, maybe a branch or remove it or something...
 user.getauthenticated also has dead code


TODO SOON
1. marketing when ok - post on other pages with examples

3. add lastUpdateTime to server - for this to work for terms + subjects, need to copy lastUPdateTIme from parent to children in db (and rerun scrapers)
and add it to collegeNames somehow (and add the ids for the neu.edu/law)



4. put base data cache on branch
make the base data cache not ghetto
need some way to call download when a data is loading and have it just return when done - test?
if .create called again with more data, need to update existing instance
more notes in BaseData.js


6. need some way for keys to distignuish between classes - this will help for instance cache and
a 2500 (hon) should just bring up the (hon) and non hon should just bring up non-hon


7. localhost#/neu.edu/latest/CS/4800


ROADMAP
change name? - courseboard.io
share link
login with google
need to implement an unsubscribe feature, create a subscriptionsKey that is emailed to user and allows control over subscriptions settings
if login key but server says no user delete login key
on startup, loop through users data and make sure each row is at minimum the default data
css minifyer
mobile
--scrape the hon attribute for hon classes




UNIT TESTS
make sure every node in tree is loaded (loadingstatus done or fail)
 -- note from below: is it safe to remove all loading status ==0? how many trees does this affect? how many trees produce erros atm?
make sure no class has >3 coreqs, and if so make sure there is enought padding between it and above class





LONG ROAD MAP
do a whois on client ip to detect which college they are coming from (will work sometimes) and prefill college
node on non 443?
----ssl ... .js file has something that showed node could work on 8443 https, idk
perma cache all old terms in localStorage
trace surveys
student reviews of classes
scrape rate my prof
add textbook data
get major/minor data
get advisor data (like which advisor(s) for which majors)
--- http://northeastern.bncollege.com/webapp/wcs/stores/servlet/TBWizardView?storeId=17555&catalogId=10001&langId=-1
---and i have code for scraping somewhere too, might be in homework repo
payments for notifications?



ODD BUGS
in the pageData async processing deps, if one fails, the main callback is called before the others are done because thats how async map handels errors
updated 0 classes [] is running in the background of spider
im thining nofix because it shouldn't crash at all...





settings:
-- hide/show/both (hon)
------if class is hon and hon coreqs exist, only match those
------else match all
------if class is not hon only match non hon
-- hide broken classes (classes that don't exist in the db but are listed as a prereq) (like all the classes that make that warning appear)
-- hide classes with no sections
-- maximum number of classes (419 just too much...)
-- depth max
-- ignore graduate classes?
later:
-- d3 vs wide mode?
-- render up and down/ or just down or just up



buttons:
-- update/refresh, that get server to update the data
-- star
-- notify
-- check mark for have taken this class


star
 -- default goes to stared courses








----- GRAPH THINGIMAJIGERS

merge coreq prereqs with class prereqs

5. https://coursepro.io/#/graph/clemson.edu/201601/AVS/2060
class requires a lower class and the lower classes's lab, which shows the lower class and its lab twice




get list of nodes sorted by allParents.length
also, below vv solve
would mg=mg work?

remove the node (branch) if it is on the top - both stuff like fundies and search --- 
there could be cases where:
a -> b or c
d -> (b or c) and (i or p)
so now there is two nodes beneth d, and need to bring a to that
ex: https://localhost/#neu.edu/201610/EECE/4792


http://localhost/#neu.edu/201610/EEMB/2616
crashes things in multi-parent


also remember the render the panels by layer thing for the multi parent
-- this was before angularjs

---end node injection problem ---





RANDOM NOTES

to detect mailinator: nslookup for 23.239.11.30 (most of their alts) or 45.33.81.172 (mailinator.com)

neu ips:
155.33.x.x
and there was one other /16 too



































0 - if a page is removed, deps will not update? if a section is deleted, will it be removed from the db?
0.5 - make databases optional
https://myswat.swarthmore.edu/pls/bwckctlg.p_disp_listcrse?term_in=201504&subj_in=CPSC&crse_in=081&schd_in=% is not parsed correctly :(
1. scrape credits from catalog page so have if no sections

3. copy desc from other sections and why do some have same name in same term?
if there are no sections in an entire subject, remove the subject. and if no sections for entire term, remove term and log something
and if no sections for entire college!?! log big warning
4. "linear algebra" in swath is there 4 times, but only 1 has desc?? - this is because it has a - in the title, which is interprited as a divider...

5. more asserts

6. - use the longer value for pre and co reqs if they are not the same between section and have same name
7. - remove duplicates from single list in prereqs (probably not going to happen ) - add this before simplify

9. base parser find dep with fields() -- find an existing pagedata.deps by a given fields, and if not exist, make one

10. array of user agents for pointer + some random data?

11. fallback to hittitle if dns fails

12. add optional terms for parsers, and if dont have 50%, complain

13. https://github.com/winstonjs/winston#using-the-default-logger



FUTURE:
user accounts -> workplace without prereqs
 - was overridden for class
 - public reviews?
 - private notes?
scrape trace?





assert subject deps
split up the asserts from deepequal...
addDep() is called everywhere withough checking to see if the dep exists already?

needs to get more of desc than just More theoretical, abstract, and rigorous than

make list of where others need to include certian elements and warn if 1<x<50
dont include credit hours "https://myswat.swarthmore.edu/pls/bwckctlg.p_disp_listcrse?term_in=201504&subj_in=MATH&crse_in=056&schd_in=%25"





//pretty sure this is done
id also say change it back to just deps: and add a loadDependencyChain() and then just search through deps for matching title
- and add the class data to the other classes

and

deps need to be processed before parent is processed so that when the parent hits the page it knows which dep to update -> load all, then parse all
instead of adding more deps (which it does currently)
and load classes: somehow -- nope





//convert the uri json to this
uri.setSearch({ foo: "bar", goodbye : ["world", "mars"] });
// uri == "?hello=mars&foo=bar&goodbye=world&goodbye=mars"











TODO:
add domain and course type (MATH, etc) and type description??? and term (actuall term, not the url thing - this can replace year) to baseparser, abstract or use the same code that is in collegenames.js

scraper.js

frontend





make sure times are parsed correcly here
https://www2.augustatech.edu/pls/ban8/bwckctlg.p_disp_listcrse?term_in=201612&subj_in=ALHS&crse_in=1127&schd_in=C



PARSERS


https://banners.presby.edu/prod/hzskschd.P_ViewSchedule
uses an old version of the site - different parser needed (easy to write, add later)
this specific college ^ either updated or has a newer version too and has already been scraped

- lazyload for gulp modules? -- emascript6 only...

courseoff reverse engieering:
 - using webpack
courseoff data structure
{
	"course": {
		"major": {
			"ident": "ACCT",
			"term": {
				"ident": 201601,
				"university": {
					"ident": "neu",
					"name": "Northeastern University",
					"features": ["seats"],
					"timezone": "America/New_York",
					"_terms": [],
					"_termsIdent": {},
					"url": "//soc.courseoff.com/neu"
				},
				"url": "//soc.courseoff.com/neu/terms/201601"
			},
			"url": "//soc.courseoff.com/neu/terms/201601/majors/ACCT"
		},
		"ident": "1202",
		"name": "Financial Accounting in a Global Context",
		"url": "//soc.courseoff.com/neu/terms/201601/majors/ACCT/courses/1202"
	},
	"call_number": "33301",
	"ident": "03",
	"credits": 4,
	"instructor": {
		"lname": "Goldman",
		"fname": "William  "
	},
	"seats": {
		"capacity": 40,
		"actual": 31,
		"remaining": 9
	},
	"seat_time": "2016-02-11T02:43:52.263Z",
	"timeslots": [{
		"day": "M",
		"location": "Dodge Hall 230",
		"start": 815,
		"end": 880
	}, {
		"day": "W",
		"location": "Dodge Hall 230",
		"start": 815,
		"end": 880
	}, {
		"day": "R",
		"location": "Dodge Hall 230",
		"start": 815,
		"end": 880
	}],
	"_visible": false,
	"_checked": false,
	"url": "//soc.courseoff.com/neu/terms/201601/majors/ACCT/courses/1202/sections/33301",
	"color": "#f27979",
	"_callbacks": {
		"pin": [null, null, null, null, null, null, null, null],
		"unpin": [null, null, null, null, null, null, null, null]
	}
}
