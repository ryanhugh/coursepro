https://coursepro.io/#/graph/ccsu.edu/201640/ACTL/465 --- fixed in master, not in prod

max number of simultanous classes wawtching???


// is the on i tested alot
http://localhost/#/graph/swarthmore.edu/201604/MATH/043

TO TEST
class name stuff -- done
queue.max on neu, etc -- done
last update time should copy down to class deps of class deps -- done
get has wait list on section -- done
why are the terms not sorted on the dropdown? -- done


LOOKING INTO
safe to lookup docs by url in backend? - ehhh
async memorize on this.download for tterms and stuff - slap in on basedata.constructor.download with a hashwer that gets all of config and config.body (how to hash obj) -- done?
the node injection graph thing
for node injection, make sure all same type and do overlapping set of names to find node name

// TODO calculate if a node has children at dfferent depts in tree mgr

is the d3 moving stuff on the screen causing the mess up of starting position????
 -- no, its gravity, and if thats removed it looks like crap ughhhhh


jasmine make sure done() not called twice?


updateing db due to change in deps because of the dep change in last update time????
Is there some good way to not have a bunch of emails go off whenever change how something is parsed?
can close and reopen the db when not prod?
trim leading 0s from classids -- done client side with a getter
if a superman parent is !class and all its children.length == superman.children.length skip the !class direcly -- done
honors?
make all the injected nodes and stuff where math.random is a thing instanceof Class -- done
speed?
coreqs
arrows
if angle < something between 2 children, do a force or maybe if x is too close between children?


GULP todo
split vender.js and app.js gulpfile
npm ignore everything in frontend/static/ and copy over the other stuff


CLALENDAR
classes can go as late as 10pm, and they are sometimes on weekends
https://myswat.swarthmore.edu/pls/bwckctlg.p_disp_listcrse?term_in=201602&subj_in=PSYC&crse_in=025&schd_in=A


TREE inverients
nodes are in parents children
nodes are in childrens parents
!classes have (>1 child or >1 parent) and at lest 1 child and at least 1 parent
all nodes connected to each other somehow
only 1 node with 0 parents
no duplicates in children or parents
panels should have text in them 
no depth > 50

crashes
http://localhost/#/graph/neu.edu/201710/ME/4570
http://localhost/#/graph/neu.edu/201710/CHEM/3505
http://localhost/#/graph/neu.edu/201710/EECE/4642
http://localhost/#/graph/neu.edu/201710/EECE/2530

when downloading a tree if it turns into a node need to set id to something reliable, like hash of prereqs title's instead of random -- done
change the type of parent to and if was included in a superman node and all of its children were included too?
http://localhost/#/graph/neu.edu/201710/ME/4640

needs multiple passes of skipNodesPostStuff??? its because if there are two in a row, it will fix the first oen then node == the next one
http://localhost/#/graph/neu.edu/201710/ME/5250

this is wrong, its just (1342 or 1252) not (1342 or 1252 or [tree])
http://localhost/#/graph/neu.edu/201710/PHYS/1155

if node -> and -> node, nothing is changed on highlight
http://localhost/#/graph/neu.edu/201710/MATH/3331

do i still need the manual memoize around class?
unit tests for ^ and memoize stuff



NOTIFICATIONS
trello/sms/phone call/etc


D3 todo
merge -- done
hover to highlight -- done
superman types -- done
d3 types -- done
panel merge -- done




POST PROCESS
make a post process folder and 
put the data in the database or just process the page datas? 
 -- cross term data copying would work pretty much either way
 -- mongodb binary search might be better for finding other classes for postreqs
 -- convert prereqs classid to classuuid too





3RD party bugs
nodejs https on that one college that isnt 443?
d3-queue for multiple awaitall? error messages?
gulp-jasmine has a bug not deleting enough files from cache
holy crap nodev6 is bad. gulp watch dosent work and npm install dosent work on armhf
---dont upgrade to nodev6 until this is fixed https://github.com/gulpjs/gulp/issues/1571
----v5.10.1
async.retry and jasmine.clock

HONORS NOTES
swathmore and sju have "honors" in title 
https://myswat.swarthmore.edu/pls/bwckschd.p_disp_detail_sched?term_in=201602&crn_in=25340
https://myswat.swarthmore.edu/pls/bwckctlg.p_disp_course_detail?cat_term_in=201602&subj_code_in=MATH&crse_numb_in=016H
https://ssb.sju.edu/pls/PRODSSB/bwckctlg.p_disp_course_detail?cat_term_in=201610&subj_code_in=CHM&crse_numb_in=126

neu has it in attributes, as different sections in same class
https://wl11gp.neu.edu/udcprod8/bwckctlg.p_disp_listcrse?term_in=201710&subj_in=CS&crse_in=1800&schd_in=LEC


TITLE NOTES
some derp names swathmore.log
in swath, would work but need to look into (1) (w) stuff more 
need to keep '-lab' at the end and standardize spacing around dash




// //update existing dep in CATALOG PARSER MAKE SURE IT WORKS and aIS IT POSSIBLE TO ADD A CLASS CODE??



// NEED TO ADD A DID FIND THIS RUN or somethign to each parsing data and then delete the controller.dep unless it was found
 -- what if the controller is not found? need controller if more than 1, else no controller, ahhhh

!!!!
db.collegeNames.remove({host:'neu.edu'})
db.term.remove({host:'neu.edu'})
db.subjects.remove({host:'neu.edu'})
db.links.remove({host:'neu.edu'})
db.classes.remove({host:'neu.edu'})
db.sections.remove({host:'neu.edu'})

db.collegeNames.remove({host:'neu.edu/law'})
db.term.remove({host:'neu.edu/law'})
db.subjects.remove({host:'neu.edu/law'})
db.links.remove({host:'neu.edu/law'})
db.classes.remove({host:'neu.edu/law'})
db.sections.remove({host:'neu.edu/law'})

db.collegeNames.remove({host:'neu.edu/cps'})
db.term.remove({host:'neu.edu/cps'})
db.subjects.remove({host:'neu.edu/cps'})
db.links.remove({host:'neu.edu/cps'})
db.classes.remove({host:'neu.edu/cps'})
db.sections.remove({host:'neu.edu/cps'})

update everything/all classes and not switch out id? or maybe store keys in localStorage and not ids?
find a better way to abstract this.table.update in userdb?


split this into backend and frontend?
finish section.tests.js

jasmine coffeescript
angular coffeescript
lodash coffeescript
ctrl-shift c for color picker

clear out db at beginning of spider? also need to remove neu.edu/law stuff

karma-failed-reporter is better than nothing



spacing bug if multiple locations on class list

put a line between years?

/logError called "class load failed" if failed to load class and then on a separate call to class.load sections

unit tests?
 - testing errors shouldnt bring up debugger
merge list, search, starred?

play with hiding private properties?
 -- nah
 do something with instance, cache, maybe a branch or remove it or something...
 user.getauthenticated also has dead code


TODO SOON
1. marketing when ok - post on other pages with examples

3. add lastUpdateTime to server - for this to work for terms + subjects, need to copy lastUPdateTIme from parent to children in db (and rerun scrapers)
and add it to collegeNames somehow (and add the ids for the neu.edu/law)



4. put base data cache on branch
make the base data cache not ghetto
need some way to call download when a data is loading and have it just return when done - test?
if .create called again with more data, need to update existing instance
more notes in BaseData.js


6. need some way for keys to distignuish between classes - this will help for instance cache and
a 2500 (hon) should just bring up the (hon) and non hon should just bring up non-hon


7. localhost#/neu.edu/latest/CS/4800


ROADMAP
change name? - courseboard.io
share link
login with google
need to implement an unsubscribe feature, create a subscriptionsKey that is emailed to user and allows control over subscriptions settings
if login key but server says no user delete login key
on startup, loop through users data and make sure each row is at minimum the default data
css minifyer
mobile
--scrape the hon attribute for hon classes




UNIT TESTS
make sure every node in tree is loaded (loadingstatus done or fail)
 -- note from below: is it safe to remove all loading status ==0? how many trees does this affect? how many trees produce erros atm?
make sure no class has >3 coreqs, and if so make sure there is enought padding between it and above class





LONG ROAD MAP
do a whois on client ip to detect which college they are coming from (will work sometimes) and prefill college
node on non 443?
----ssl ... .js file has something that showed node could work on 8443 https, idk
perma cache all old terms in localStorage
trace surveys
student reviews of classes
scrape rate my prof
add textbook data
--- http://northeastern.bncollege.com/webapp/wcs/stores/servlet/TBWizardView?storeId=17555&catalogId=10001&langId=-1
---and i have code for scraping somewhere too, might be in homework repo
payments for notifications?



ODD BUGS
in the pageData async processing deps, if one fails, the main callback is called before the others are done because thats how async map handels errors
updated 0 classes [] is running in the background of spider
im thining nofix because it shouldn't crash at all...





settings:
-- hide/show/both (hon)
------if class is hon and hon coreqs exist, only match those
------else match all
------if class is not hon only match non hon
-- hide broken classes (classes that don't exist in the db but are listed as a prereq) (like all the classes that make that warning appear)
-- hide classes with no sections
-- maximum number of classes (419 just too much...)
-- depth max
-- ignore graduate classes?
later:
-- d3 vs wide mode?
-- render up and down/ or just down or just up



buttons:
-- update/refresh, that get server to update the data
-- star
-- notify
-- check mark for have taken this class


star
 -- default goes to stared courses








----- GRAPH THINGIMAJIGERS

merge coreq prereqs with class prereqs

5. https://coursepro.io/#/graph/clemson.edu/201601/AVS/2060
class requires a lower class and the lower classes's lab, which shows the lower class and its lab twice




get list of nodes sorted by allParents.length
also, below vv solve
would mg=mg work?

remove the node (branch) if it is on the top - both stuff like fundies and search --- 
there could be cases where:
a -> b or c
d -> (b or c) and (i or p)
so now there is two nodes beneth d, and need to bring a to that
ex: https://localhost/#neu.edu/201610/EECE/4792


http://localhost/#neu.edu/201610/EEMB/2616
crashes things in multi-parent


also remember the render the panels by layer thing for the multi parent
-- this was before angularjs

---end node injection problem ---





RANDOM NOTES

to detect mailinator: nslookup for 23.239.11.30 (most of their alts) or 45.33.81.172 (mailinator.com)

neu ips:
155.33.x.x
and there was one other /16 too

tree is 419 big
https://localhost/#neu.edu/201630/CHEM/5622


































0 - if a page is removed, deps will not update? if a section is deleted, will it be removed from the db?
0.5 - make databases optional
https://myswat.swarthmore.edu/pls/bwckctlg.p_disp_listcrse?term_in=201504&subj_in=CPSC&crse_in=081&schd_in=% is not parsed correctly :(
1. scrape credits from catalog page so have if no sections

3. copy desc from other sections and why do some have same name in same term?
if there are no sections in an entire subject, remove the subject. and if no sections for entire term, remove term and log something
and if no sections for entire college!?! log big warning
4. "linear algebra" in swath is there 4 times, but only 1 has desc?? - this is because it has a - in the title, which is interprited as a divider...

5. more asserts

6. - use the longer value for pre and co reqs if they are not the same between section and have same name
7. - remove duplicates from single list in prereqs (probably not going to happen ) - add this before simplify

9. base parser find dep with fields() -- find an existing pagedata.deps by a given fields, and if not exist, make one

10. array of user agents for pointer + some random data?

11. fallback to hittitle if dns fails

12. add optional terms for parsers, and if dont have 50%, complain

13. https://github.com/winstonjs/winston#using-the-default-logger



FUTURE:
user accounts -> workplace without prereqs
 - was overridden for class
 - public reviews?
 - private notes?
scrape trace?





assert subject deps
split up the asserts from deepequal...
addDep() is called everywhere withough checking to see if the dep exists already?

needs to get more of desc than just More theoretical, abstract, and rigorous than

make list of where others need to include certian elements and warn if 1<x<50
dont include credit hours "https://myswat.swarthmore.edu/pls/bwckctlg.p_disp_listcrse?term_in=201504&subj_in=MATH&crse_in=056&schd_in=%25"





//pretty sure this is done
id also say change it back to just deps: and add a loadDependencyChain() and then just search through deps for matching title
- and add the class data to the other classes

and

deps need to be processed before parent is processed so that when the parent hits the page it knows which dep to update -> load all, then parse all
instead of adding more deps (which it does currently)
and load classes: somehow -- nope





//convert the uri json to this
uri.setSearch({ foo: "bar", goodbye : ["world", "mars"] });
// uri == "?hello=mars&foo=bar&goodbye=world&goodbye=mars"











TODO:
add domain and course type (MATH, etc) and type description??? and term (actuall term, not the url thing - this can replace year) to baseparser, abstract or use the same code that is in collegenames.js

scraper.js

frontend





make sure times are parsed correcly here
https://www2.augustatech.edu/pls/ban8/bwckctlg.p_disp_listcrse?term_in=201612&subj_in=ALHS&crse_in=1127&schd_in=C



PARSERS


https://banners.presby.edu/prod/hzskschd.P_ViewSchedule
uses an old version of the site - different parser needed (easy to write, add later)
this specific college ^ either updated or has a newer version too and has already been scraped

- lazyload for gulp modules? -- emascript6 only...

courseoff reverse engieering:
 - using webpack
courseoff data structure
{
	"course": {
		"major": {
			"ident": "ACCT",
			"term": {
				"ident": 201601,
				"university": {
					"ident": "neu",
					"name": "Northeastern University",
					"features": ["seats"],
					"timezone": "America/New_York",
					"_terms": [],
					"_termsIdent": {},
					"url": "//soc.courseoff.com/neu"
				},
				"url": "//soc.courseoff.com/neu/terms/201601"
			},
			"url": "//soc.courseoff.com/neu/terms/201601/majors/ACCT"
		},
		"ident": "1202",
		"name": "Financial Accounting in a Global Context",
		"url": "//soc.courseoff.com/neu/terms/201601/majors/ACCT/courses/1202"
	},
	"call_number": "33301",
	"ident": "03",
	"credits": 4,
	"instructor": {
		"lname": "Goldman",
		"fname": "William  "
	},
	"seats": {
		"capacity": 40,
		"actual": 31,
		"remaining": 9
	},
	"seat_time": "2016-02-11T02:43:52.263Z",
	"timeslots": [{
		"day": "M",
		"location": "Dodge Hall 230",
		"start": 815,
		"end": 880
	}, {
		"day": "W",
		"location": "Dodge Hall 230",
		"start": 815,
		"end": 880
	}, {
		"day": "R",
		"location": "Dodge Hall 230",
		"start": 815,
		"end": 880
	}],
	"_visible": false,
	"_checked": false,
	"url": "//soc.courseoff.com/neu/terms/201601/majors/ACCT/courses/1202/sections/33301",
	"color": "#f27979",
	"_callbacks": {
		"pin": [null, null, null, null, null, null, null, null],
		"unpin": [null, null, null, null, null, null, null, null]
	}
}
