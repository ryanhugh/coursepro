<!DOCTYPE html>
<meta charset="utf-8">
<style>
/*.node {
    stroke: #fff;
    stroke-width: 1.5px;
}

.link {
    fill: none;
    stroke: #bbb;
}*/

.link {
    stroke: #ccc;
}

.node text {
    pointer-events: none;
    font: 10px sans-serif;
}
</style>
<link rel="stylesheet" href="/css/bootstrap.min.css">

<body>
    <script src="//d3js.org/d3.v3.min.js"></script>
    <script>


var width = 960,
    height = 500;

var color = d3.scale.category20();

var force = d3.layout.force()
    .charge(-120)
    .linkDistance(30)
    .size([width, height]);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

d3.json("thing.json", function(error, graph) {
  if (error) throw error;

  force
      .nodes(graph.nodes)
      .links(graph.links)
      .start();

  var link = svg.selectAll(".link")
      .data(graph.links)
    .enter().append("line")
      .attr("class", "link")
      .style("stroke-width", function(d) { return Math.sqrt(d.value); });

  var node = svg.selectAll(".node")
      .data(graph.nodes)
    .enter().append("g")
      .attr("class", "node")
      .call(force.drag);

  // node.append("title")
  //     .text(function(d) { return d.name; });

      
  node.html('<foreignObject width="125" height="50"><div class="panel panel-primary"> <div class="panel-heading"> <h3 class="panel-title">Panel title</h3> </div> <div class="panel-body"> Panel content </div> </div></foreignObject>')



  force.on("tick", function() {
    link.attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; });

    node.attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; });
  });
  });


// var width = 2000,
//     height = 800;

// var color = d3.scale.category20();

// var force = d3.layout.force()
//     .linkDistance(50)
//     .linkStrength(2)
//     .charge(-200)
//     .size([width, height]);

// var svg = d3.select("body").append("svg")
//     .attr("width", width)
//     .attr("height", height);

// d3.json("/thing.json", function(error, graph) {
//   if (error) throw error;

//   // var nodes = graph.nodes.slice(),
//   //     links = [],
//   //     bilinks = [];

//   // graph.links.forEach(function(link) {
//   //   var s = nodes[link.source],
//   //       t = nodes[link.target],
//   //       i = {}; // intermediate node
//   //   nodes.push(i);
//   //   links.push({source: s, target: i}, {source: i, target: t});
//   //   bilinks.push([s, i, t]);
//   // });

//   force
//       .nodes(graph.nodes)
//       .links(graph.links)
//       .start();

//   var link = svg.selectAll(".link")
//   .data(graph.links)
//     .enter().append("path")
//       .attr("class", "link");



// // d3.json("/thing.json", function(error, json) {
// //   if (error) throw error;

// //   force
// //       .nodes(json.nodes)
// //       .links(json.links)
// //       .start();

//   // var link = svg.selectAll(".link")
//   //     .data(json.links)
//   //   .enter().append("line")
//   //     .attr("class", "link");

//   var node = svg.selectAll(".node")
//       .data(graph.nodes)
//     .enter().append("g")
//       .attr("class", "node")
//       .call(force.drag);

//   // node.append("image")
//   //     .attr("xlink:href", "https://github.com/favicon.ico")
//   //     .attr("x", -8)
//   //     .attr("y", -8)
//   //     .attr("width", 16)
//   //     .attr("height", 16);

//   // node.append("text")
//   //     .attr("dx", 12)
//   //     .attr("dy", ".35em")
//   //     .text(function(d) { return d.name });

//   node.html('<foreignObject width="125" height="50"><div class="panel panel-primary"> <div class="panel-heading"> <h3 class="panel-title">Panel title</h3> </div> <div class="panel-body"> Panel content </div> </div></foreignObject>')

//   // force.on("tick", function() {
//   //   link.attr("x1", function(d) { return d.source.x; })
//   //       .attr("y1", function(d) { return d.source.y; })
//   //       .attr("x2", function(d) { return d.target.x; })
//   //       .attr("y2", function(d) { return d.target.y; });
        
//   // force.on("tick", function() {
//   //   link.attr("d", function(d) {
//   //     return "M" + d[0].x + "," + d[0].y
//   //         + "S" + d[1].x + "," + d[1].y
//   //         + " " + d[2].x + "," + d[2].y;
//   //   });

//   //   node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });
//   // });

//  force.on("tick", function() {
//     link.attr("x1", function(d) { return d.source.x; })
//         .attr("y1", function(d) { return d.source.y; })
//         .attr("x2", function(d) { return d.target.x; })
//         .attr("y2", function(d) { return d.target.y; });

//     node.attr("cx", function(d) { return d.x; })
//         .attr("cy", function(d) { return d.y; });
//   });


// });


//   var node = svg.selectAll(".node")
//       .data(graph.nodes)
//     .enter().append("circle")
//       .attr("class", "node")
//       .attr("r", 5)
//       .style("fill", function(d) { return color(d.group); })
//       .call(force.drag);

//   // node.append("title")
//   //     .text(function(d) { return d.name; });


//   node.append("text")
//       .attr("dx", 12)
//       .attr("dy", ".35em")
//       .text(function(d) { return d.name });


//   force.on("tick", function() {
//     link.attr("d", function(d) {
//       return "M" + d[0].x + "," + d[0].y
//           + "S" + d[1].x + "," + d[1].y
//           + " " + d[2].x + "," + d[2].y;
//     });
//     node.attr("transform", function(d) {
//       return "translate(" + d.x + "," + d.y + ")";
//     });
//   });
// });

</script>

    <!-- <div class="panel panel-primary"> <div class="panel-heading"> <h3 class="panel-title">Panel title</h3> </div> <div class="panel-body"> Panel content </div> </div>

 -->
