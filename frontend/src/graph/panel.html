<!--template panel, used for trees-->
<!-- remove the white-space below and above to wrap the panels -->
<!-- baseZIndex needs to be set in this scope before included (it is currently set in graphInner.html) -->
 

<div class="treePanelWrapper" ng-style="style" style="z-index:100" graph-linker graph-line-to-parent>


    <!-- main panel -->
    <div class="panel panel-primary treePanel" ng-if="tree.isClass && !tree.hidden" graph-panel-expand panel-close=".closePanel" help>

        <div class="panel-heading">
            <h3 class="panel-title" style="text-align: center;">
            	
            	
            	<span ng-if ="tree.isString">{{::tree.desc}} </span>
            	
            	{{::tree.subject}} {{::tree.classId}}
                <br/> 
                {{::tree.name}}
            </h3>

            <span ng-show="isExpanded">
                <span class="glyphicon glyphicon-remove closePanel" aria-hidden="true" style="position: absolute;right: 7px;top: 7px;cursor: pointer;"></span>
                <!-- <div ng-init="class = tree" list-icon='watching' toggle-sections='true' toggle='class' style="position: absolute;top: 5px;right: 27px;"></div> -->
 
                <!-- was 48 -->
                <div ng-if ="tree.dataStatus !== macros.DATASTATUS_FAIL" ng-init="class = tree" list-icon='saved' toggle-sections='true' toggle='class' style="position: absolute;top: 5px;right: 27px;"></div>

            </span>

        </div>

        <!-- only the panel body changes on isExpanded -->
        <div ng-if="isExpanded" class="panel-body panelBodyId" style="line-height: 14px;" ng-style="{'width':panelWidth+'px'}">
            <div ng-if="tree.dataStatus === macros.DATASTATUS_DONE">
                <div style="white-space: normal;margin-bottom:10px;line-height:15px">{{tree.desc}}</div>


                <!-- 
                <div style="text-align: center;margin-bottom: -20px;">
                    <a class="linkToClassWatchModel" ng-click="graph.openWatchModel(this)">Get notified if this class changes
                        <br> or if any seats open up!</a>
                </div> -->
                <div>
                    <div style="text-align:left;display: inline-block; position: absolute;max-width: 50%;line-height: 15px;">
                        <span ng-if="tree.maxCredits">
                            <span ng-if="tree.maxCredits === tree.minCredits">
                                {{tree.maxCredits}}
                            </span>
                            <span ng-if="tree.maxCredits !== tree.minCredits">
                                {{tree.minCredits}} to {{tree.maxCredits}}
                            </span>
                            credits
                        </span>
                        <br>
                        <span ng-if="tree.lastUpdateString">
                            Updated {{tree.lastUpdateString}}
                        </span>
                    </div>
                    <div style="text-align: right; display: inline-block; float: right; white-space: normal; max-width: 50%; min-width: 53px;">
                        <a target="_blank" href="{{tree.prettyUrl}}">View on {{tree.host}}</a>
                    </div>
                </div>



                <div style="text-align:center;display: inline-block;padding-top:10px;width: 100%;margin-bottom: -10px;">
                    <div style="width: 260px;position: relative;" ng-repeat="section in tree.sections" class="classSection">

                        <div list-icon='saved' toggle='section' style="position: absolute;top: 4px;right: 4px;"></div>

                        <div style=" text-align: center;margin-bottom: 22px;">
                            <span ng-repeat="meeting in ::section.meetings" ng-if="!meeting.hidden">


                                <span ng-if="::meeting.getIsExam()">
                                    Exam
                                    <br>
                                </span>

                                <!-- times, eg 10:30 - 11:35 am -->
                                <span ng-repeat="time in ::meeting.times">
                                    {{time[0].start.format('h:mm')}} - {{time[0].end.format('h:mm a')}}
                                </span>&nbsp;

                                <br ng-if="::!meeting.getIsExam()">

                                <!-- days, eg Monday, Wednesday, Thursday -->
                                {{::meeting.getWeekdayStrings().join(',&nbsp;')}}

                                <span ng-if="::meeting.getIsExam()">
                                    {{::meeting.startDate.format('MMM Do')}}
                                </span>

                                <br>

                                <!-- hr/week jawn, eg 3.3 hours/week -->
                                {{::meeting.getHoursPerWeek()}}
                                <span ng-if="::meeting.getIsExam()">hours</span>
                                <span ng-if="::!meeting.getIsExam()">hours/week</span>



                                <br>

                                <!-- location, eg International Village 019, but with href -->

                                <span ng-switch on="::meeting.location.toLowerCase()">
                                    <span ng-switch-when="tba">location undecided</span>
                                    <span ng-switch-when="">location undecided</span>
                                    <span ng-switch-when="web online">Web Online</span>
                                    <span ng-switch-default>

                                        <a target="_blank" href="http://maps.google.com/?q={{::graph.getCollegeName() +' '+ meeting.getBuilding()}}">{{meeting.where}}</a>

                                    </span>
                                </span>
                                <br>
                                <br>
                            </span>
                        </div>

                        <div class="lowerSectionInfo">
                            <div style="display: inline-block;max-width: 50%;">


                                {{::section.getProfs().join(',&nbsp;')}}


                                <br> CRN: {{section.crn}}</div>
                            <div style="text-align: right; display: inline-block; float: right; white-space: normal; max-width: 50%; min-width: 53px;" class="rightSectionText"> {{::section.seatsRemaining}}/{{::section.seatsCapacity}} seats
                                <br>
                                <a target="_blank" href="{{::section.url}}">View on {{::section.host}}</a>
                            </div>
                        </div>
                    </div>
                </div>



            </div>

            <div ng-if="::tree.dataStatus === macros.DATASTATUS_FAIL">

                0 sections this term
                <div style="white-space: normal;">
                    <br>Couldn't find any class info on
                    <br> {{::tree.host}} :( </div>
            </div>
        </div>


        <!-- !isExpanded must be watching (no ::) -->
        <div ng-if="!isExpanded" class="panel-body panelBodyId" style="line-height: 14px;">
            <div ng-if="::tree.dataStatus===macros.DATASTATUS_FAIL">0 sections this term</div>

            <ng-pluralize ng-if="::tree.dataStatus!==macros.DATASTATUS_FAIL" count="::tree.crns.length" when="{'1':'{} section this term','other':'{} sections this term'}"></ng-pluralize>
        </div>


    </div>
    <!-- circle node in graph -->
    <div ng-if="!tree.isClass && !tree.hidden" style="width: 35px; height: 35px; border-radius: 50%;z-index: 150;position: relative;margin: 0px auto; background-color: rgb(0, 0, 255);"></div>

    <div ng-if="tree.hidden"></div>

</div>
